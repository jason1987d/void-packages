# Template file for 'nebula_dht'
pkgname=nebula_dht
version=2.4.1
revision=1
hostmakedepends="just go"
depends="postgresql"
checkdepends="${depends} docker"
short_desc="DHT (and other network) crawler, monitor, measurement tool"
maintainer="Jason Elswick <jason@jasondavid.us>"
license="Apache-2.0"
homepage="https://github.com/dennis-tra/nebula"
distfiles="https://github.com/dennis-tra/nebula/archive/refs/tags/${version}.tar.gz"
checksum=3862ff5ec17ace3ec3b9814bb04fb7fa4cf2b5db19e97a489bdab695f429242d
nopie=yes
make_check=no # need to figure out

post_patch() {
	sed -i "s|^VERSION \:\= \`.*\`$|VERSION := \"$version\"|" justfile
}

do_build() {
	just build
}

do_install() {
	vmkdir usr/bin/
	vbin dist/nebula nebula_dht
}

do_check() {
	just test
}
