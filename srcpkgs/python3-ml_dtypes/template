# Template file for 'python3-ml_dtypes'
pkgname=python3-ml_dtypes
version=0.5.4
revision=1
build_style=python3-pep517
hostmakedepends="python3-setuptools python3-wheel"
makedepends="python3-numpy python-devel"
depends="python3-numpy python3-platformdirs"
checkdepends="${depends} python3-pytest python3-absl python3-pytest-xdist python3-pyink python3-pylint"
short_desc="Implementation of NumPy dtype machine learning extensions"
maintainer="Jason Elswick <jason@jasondavid.us>"
license="Apache-2.0,MPL-2.0"
homepage="https://github.com/jax-ml/ml_dtypes"
_eigen_gitrev=7bf2968fed5f246c0589e1111004cb420fcd7c71
distfiles="https://github.com/jax-ml/ml_dtypes/archive/refs/tags/v${version}.tar.gz
 https://gitlab.com/libeigen/eigen/-/archive/${_eigen_gitrev}.tar.gz"
checksum="acaef497b420a15761cb525562b04d880b5c7afacea02d435a5d166fd8a99a16
 beca76e4663a75ef3ff00b0704009a7a60cec3783ce3cada0b828982da87130b"
skip_extraction="${_eigen_gitrev}.tar.gz"

post_extract() {
	vsrcextract -C third_party/eigen ${_eigen_gitrev}.tar.gz
	sed -i pyproject.toml -e 's/setuptools~=80.9.0/setuptools/g'
}
